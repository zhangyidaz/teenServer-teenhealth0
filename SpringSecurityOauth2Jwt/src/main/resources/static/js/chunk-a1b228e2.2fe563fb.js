(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a1b228e2","chunk-2d21732b","chunk-2d0d780d"],{"76a9":function(e,t,r){"use strict";r.r(t),r.d(t,"crudOptions",(function(){return n}));var i=r("be16"),s=r("22ce"),n=function(e){return{options:{height:"100%"},rowHandle:{width:180,view:{thin:!0,text:null,disabled:function(){return!e.hasPermissions("usersphere:user:view")}},edit:{thin:!0,text:null,disabled:function(){return!e.hasPermissions("usersphere:user:edit")}},remove:{thin:!0,text:null,disabled:function(){return!e.hasPermissions("usersphere:user:del")}},custom:[{thin:!0,text:null,type:"warning",size:"small",emit:"authz",icon:"el-icon-s-flag",disabled:function(){return!e.hasPermissions("usersphere:user:authz")}}]},columns:[{title:"id",key:"id",width:70,form:{disabled:!0},sortable:!0},{title:"创建时间",key:"createTime",type:"datetime",width:140,form:{disabled:!0},sortable:!0},{title:"修改时间",key:"updateTime",type:"datetime",width:140,form:{disabled:!0},sortable:!0},{title:"用户名",key:"username",search:{disabled:!1},form:{editDisabled:!0,rules:[{required:!0,message:"请输入用户名"}]},sortable:!0},{title:"密码",key:"password",form:{component:{props:{showPassword:!0}},helper:"填写则修改密码"},disabled:!0,sortable:!0},{title:"昵称",key:"nickname",search:{disabled:!1},sortable:!0},{title:"手机号",key:"mobileValue",type:"phoneNumber",width:150,form:{rules:[{required:!0,message:"请输入手机号"},{validator:i["mobileValidator"],message:"手机号不正确"}]},valueBuilder:function(e){e.mobileValue={phoneNumber:e.mobile,callingCode:e.callingCode}},valueResolve:function(e){null!=e.mobileValue&&(e.mobile=e.mobileValue.phoneNumber,e.callingCode=e.mobileValue.callingCode)},search:{disabled:!1,width:"260px"},sortable:!0},{title:"头像",key:"avatar",type:"avatar-uploader",width:100,sortable:!0},{title:"性别",key:"gender",type:"radio",width:70,dict:{data:[{value:1,label:"男"},{value:2,label:"女",color:"danger"}]},sortable:!0},{title:"邮箱",key:"email",search:{disabled:!1},form:{rules:[{required:!1,message:"请输入邮箱"},{type:"email",message:"请输入正确的邮箱"}]},sortable:!0},{title:"角色",key:"roles",type:"select",width:250,dict:{url:"/permission/manager/role/list",value:"id",label:"name",getData:function(e,t){return Object(s["a"])({url:e}).then((function(e){return e.data}))}},search:{disabled:!0},form:{disabled:!0},view:{disabled:!0},sortable:!0}]}}},a305:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("d2-container",{class:{"page-compact":e.crud.pageOptions.compact}},[r("template",{slot:"header"},[e._v(" 用户管理 "),r("example-helper",{attrs:{title:"权限管理帮助"}},[r("div",[r("link-button",{attrs:{href:"http://greper.gitee.io/d2-crud-plus/guide/permission.html"}},[e._v("权限管理帮助文档")])],1)])],1),r("d2-crud-x",e._g(e._b({ref:"d2Crud",on:{authz:e.authzHandle}},"d2-crud-x",e._crudProps,!1),e._crudListeners),[r("div",{attrs:{slot:"header"},slot:"header"},[r("crud-search",{ref:"search",attrs:{options:e.crud.searchOptions},on:{submit:e.handleSearch}}),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"usersphere:user:add",expression:"'usersphere:user:add'"}],attrs:{slot:"header",size:"small",type:"primary"},on:{click:e.addRow},slot:"header"},[r("i",{staticClass:"el-icon-plus"}),e._v(" 新增")]),r("crud-toolbar",{attrs:{search:e.crud.searchOptions.show,compact:e.crud.pageOptions.compact,columns:e.crud.columns},on:{"update:search":function(t){return e.$set(e.crud.searchOptions,"show",t)},"update:compact":function(t){return e.$set(e.crud.pageOptions,"compact",t)},refresh:function(t){return e.doRefresh()},"columns-filter-changed":e.handleColumnsFilterChanged}})],1)]),r("el-dialog",{attrs:{title:"授予角色",visible:e.dialogPermissionVisible},on:{"update:visible":function(t){e.dialogPermissionVisible=t}}},[r("el-checkbox-group",{model:{value:e.checkedRoleIds,callback:function(t){e.checkedRoleIds=t},expression:"checkedRoleIds"}},e._l(e.roleList,(function(t){return r("el-checkbox",{key:t.id,staticClass:"d2-mb-10",attrs:{label:t.id}},[e._v(e._s(t.name))])})),1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatePermession(e.currentUserId)}}},[e._v("确定 ")])],1)],1)],2)},s=[],n=(r("4de4"),r("c975"),r("d81d"),r("76a9")),a=r("1fbf"),o=r("c668"),u={name:"User",mixins:[a["d2CrudPlus"].crud],data:function(){return{roleList:[],checkedRoleIds:[],dialogPermissionVisible:!1,currentUserId:void 0}},methods:{getCrudOptions:function(){return Object(n["crudOptions"])(this)},pageRequest:function(e){return o["GetList"](e)},addRequest:function(e){return o["AddObj"](e)},updateRequest:function(e){return o["UpdateObj"](e)},delRequest:function(e){return o["DelObj"](e.id)},infoRequest:function(e){return o["GetObj"](e.id)},authzHandle:function(e){var t=this;o["GetRoleList"]().then((function(r){var i=r.data,s=e.row.roles;null==s&&(s=[]);var n=i.map((function(e){return e.id})).filter((function(e){return s.indexOf(e)>=0}));t.$set(t,"checkedRoleIds",n),t.$set(t,"roleList",i),t.currentUserId=e.row.id,t.dialogPermissionVisible=!0}))},updatePermession:function(e){var t=this;o["DoAuthz"](e,this.checkedRoleIds).then((function(e){t.dialogPermissionVisible=!1,t.doRefresh()}))}}},l=u,d=r("2877"),c=Object(d["a"])(l,i,s,!1,null,null,null);t["default"]=c.exports},c668:function(e,t,r){"use strict";r.r(t),r.d(t,"GetList",(function(){return n})),r.d(t,"AddObj",(function(){return a})),r.d(t,"UpdateObj",(function(){return o})),r.d(t,"DelObj",(function(){return u})),r.d(t,"GetObj",(function(){return l})),r.d(t,"GetRoleList",(function(){return d})),r.d(t,"DoAuthz",(function(){return c}));var i=r("22ce"),s="/usersphere/manager/user";function n(e){return Object(i["a"])({url:s+"/page",method:"get",params:e})}function a(e){return Object(i["a"])({url:s+"/add",method:"post",data:e})}function o(e){return Object(i["a"])({url:s+"/update",method:"post",data:e})}function u(e){return Object(i["a"])({url:s+"/delete",method:"post",params:{id:e}})}function l(e){return Object(i["a"])({url:s+"/info",method:"get",params:{id:e}})}function d(){return Object(i["a"])({url:s+"/getAllRole",method:"get"})}function c(e,t){return Object(i["a"])({url:s+"/authz",method:"post",params:{userId:e},data:t})}}}]);